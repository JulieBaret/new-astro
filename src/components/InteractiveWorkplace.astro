---
import { Picture } from 'astro:assets';
import background from '../assets/cosy_workplace/background.png';
import reflect from '../assets/cosy_workplace/reflect.png';
import WobblingPlant from './WobblingPlant.astro';

const sharedClass = 'md:h-[90dvh] md:w-auto w-full h-full';
---

<div class="ps-4 pe-4 md:ps-6 lg:ps-12 md:pe-0 md:py-0 py-4 w-full md:w-auto overflow-hidden">
    <div class={sharedClass} style={{ position: 'relative', overflow: 'visible' }}>
        <img
            id="random-poster"
            class={sharedClass}
            style="position: absolute; bottom: 0; left: 0; z-index: -1"
            alt="Random poster"
            loading="eager"
        />
        <Picture
            class={sharedClass}
            style={{
                position: 'absolute',
                width: '35%',
                height: 'auto',
                top: '28%',
                right: '18%',
                zIndex: -1,
                rotate: '-10deg',
                animation: 'diagonal 3s infinite ease-in-out',
            }}
            src={reflect}
            alt="Light reflect"
            loading="eager"
        />
        <Picture
            class={sharedClass}
            style={{
                objectFit: 'cover',
                borderRadius: '230% 170% 160% 123% / 100% 100% 70% 50%',
            }}
            src={background}
            alt="Cosy workplace"
            loading="eager"
        />
        <div class="absolute bottom-[3%] -left-[2%] z-10 w-full">
            <WobblingPlant />
        </div>
    </div>
</div>

<style>
    @keyframes diagonal {
        0% {
            transform: translate(0, 0);
            opacity: 0.2;
        }

        30% {
            transform: translate(100%, -100%);
            opacity: 0.2;
        }

        31% {
            transform: translate(100%, -100%);
            opacity: 0;
        }

        100% {
            transform: translate(0, 0);
            opacity: 0;
        }
    }
</style>

<script is:inline>
const posters = [
    '/images/arcane_poster.png',
    '/images/fleabag_poster.png',
    '/images/shera_poster.png',
];

const randomPoster = posters[ Math.floor( Math.random() * posters.length ) ];
const posterImg = document.getElementById( 'random-poster' );
if ( posterImg )
{
    posterImg.src = randomPoster; // Set the source to the chosen random poster
}
</script>
